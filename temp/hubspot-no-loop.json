{
	"name": "e4-hubspot-clients",
	"svgString": "",
	"details": {
		"title": {
			"en": "E4. Syncs Hubspot's companies into ITM Platform's clients",
			"es": "pseudo-Hubspot",
			"pt": "pseudo-Hubspot"
		},
		"version": "0.8",
		"shortDescription": {
			"en": "Syncs companies from other platform",
			"es": "sincroniza los clientes de platform con los clientes en ITM Platform",
			"pt": ""
		},
		"longDescription": {
			"en": "",
			"es": "",
			"pt": ""
		},
		"updated": "2021-11-15",
		"developer": "ITM Platform"
	},
	"features": [
		{
			"trigger": "scheduler",
			"description": "Syncs companies from Hubspot",
			"async": true,
			"actions": [
				{
					"action": "restcall",
					"url": "http://new-api.itmplatform.com/revamping/testsmarter/login/{{ config.apikey }}",
					"method": "GET",
					"description": "Login with API Key",
					"output": "loginInfo",
					"payload": "",
					"dataType": "application/json"
				},
				{
					"action": "restcall",
					"url": "https://api.hubapi.com/crm/v3/objects/companies/search/?hapikey={{ config.apikeyHubspot }}",
					"condition": "{{ context.LastExecution }} == null",
					"method": "POST",
					"description": "This condition checks if it is the first time or if the last execution failed. Retrieve all clients that match condtions the first time. We retrieve the companies that have the sync_itm_platform field set to true",
					"output": "companiesHS",
					"payload": "{\"filterGroups\":[{\"filters\":[{\"propertyName\":\"sync_itm_platform\",\"operator\":\"EQ\",\"value\":\"true\"}]}]}",
					"dataType": "application/json"
				},
				{
					"action": "restcall",
					"url": "https://api.hubapi.com/companies/v2/companies/recent/modified?hapikey={{config.apikeyHubspot }}&since={{ context.LastExecution }}",
					"condition": "{{ context.LastExecution }} != null",
					"method": "GET",
					"description": "This restcall gets all the companies modified since the lastExecutiondate",
					"output": "companiesHS",
					"payload": "",
					"dataType": "application/json"
				},
				{
                    "action": "email",
                    "to": "daniel.piret@itmplatform.com",
                    "subject": "clients",
                    "body": "<html><ul>{{#each companiesHS.results}}<li>Company: {{ this.id }} </li>{{/each}}</ul></html>"
    
				}
				]
		}
	],
	"config": [
		{
			"name": "isactive",
			"label": {
				"en": "Activate connector",
				"es": "Activar conector",
				"pt": "Ativar o conector"
			},
			"tooltip": {
				"en": "When selected, the connector will be active and will start synchronizing data",
				"es": "Cuando esté seleccionado, el conector estará activo y comenzará a sincronizar datos",
				"pt": "Quando selecionado, o conector estará ativo e começará a sincronizar dados"
			},
			"type": "checkbox",
			"required": false
		},
		{
			"name": "apikey",
			"label": {
				"en": "API Key",
				"es": "API Key",
				"pt": "API Key"
			},
			"tooltip": {
				"en": "API Key",
				"es": "API Key",
				"pt": "API Key"
			},
			"type": "string",
			"required": true
		},
		{
			"name": "apikeyHubspot",
			"label": {
				"en": "Hubspot API Key",
				"es": "Hubspot API Key",
				"pt": "Hubspot API Key"
			},
			"tooltip": {
				"en": " HubspotAPI Key",
				"es": "Hubspot API Key",
				"pt": "Hubspot API Key"
			},
			"type": "string",
			"required": true
		},
		{
			"name": "synchronizationfrequency",
			"label": {
				"en": "Synchronization frequency (minutes)",
				"es": "Frecuencia sincronización (minutos)",
				"pt": "Frequência de sincronização (em minutos)"
			},
			"tooltip": {
				"en": "Frequency you wish to establish for the synchronization of the data from you Hubspot account",
				"es": "Frecuencia con la que prefieres establecer la sincronización de los datos de tu cuenta de Hubspot",
				"pt": "Frequência com que prefere estabelecer a sincronização de dados de sua conta Hubspot"
			},
			"type": "string",
			"required": true
		}
	]
}